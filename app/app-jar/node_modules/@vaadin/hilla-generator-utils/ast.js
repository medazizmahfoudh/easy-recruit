import ts, {
} from "typescript";
function template(code, selectorOrTransformers, transformers) {
  let selector;
  if (Array.isArray(selectorOrTransformers)) {
    transformers = selectorOrTransformers;
  } else {
    selector = selectorOrTransformers;
  }
  let sourceFile = ts.createSourceFile("f.ts", code, ts.ScriptTarget.Latest, false);
  if (transformers) {
    [sourceFile] = ts.transform(
      sourceFile,
      transformers
    ).transformed;
  }
  return selector?.(sourceFile.statements) ?? sourceFile.statements;
}
function transform(transformer) {
  return (context) => (root) => {
    const visitor = (node) => {
      const transformed = transformer(node);
      if (transformed !== node) {
        return transformed;
      }
      return ts.visitEachChild(transformed, visitor, context);
    };
    return ts.visitEachChild(root, visitor, context);
  };
}
function traverse(node, visitor) {
  function _visitor(n) {
    return visitor(n) ?? ts.forEachChild(n, _visitor);
  }
  return _visitor(node);
}
export {
  template,
  transform,
  traverse
};
//# sourceMappingURL=ast.js.map
